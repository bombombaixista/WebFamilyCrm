@{
    ViewData["Title"] = "WebFamily";
}

<h2 class="text-center mb-4 bg-primary text-white p-3 rounded shadow">WebFamily</h2>

<button id="addCardBtn" class="btn btn-success mb-3 shadow">Adicionar Card</button>

<div class="row" id="myKanban">
    <div class="col kanban-column" id="todo">
        <h4 class="bg-danger text-white p-2 rounded">To Do</h4>
        <div class="kanban-list"></div>
    </div>

    <div class="col kanban-column" id="doing">
        <h4 class="bg-warning text-dark p-2 rounded">Doing</h4>
        <div class="kanban-list"></div>
    </div>

    <div class="col kanban-column" id="done">
        <h4 class="bg-success text-white p-2 rounded">Done</h4>
        <div class="kanban-list"></div>
    </div>
</div>

@section Styles {
    <style>
        /* Colunas com tom uniforme mais escuro */
        .kanban-list {
            min-height: 200px;
            padding: 10px;
            background-color: #d6d8d9; /* cinza médio */
            border-radius: 8px;
        }

        .kanban-item {
            background: #fff;
            border-radius: 6px;
            padding: 10px;
            margin-bottom: 10px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            position: relative;
        }

            .kanban-item strong {
                display: block;
                font-weight: bold;
                margin-bottom: 4px;
            }

            .kanban-item small {
                color: #333;
            }

        .btn-delete {
            cursor: pointer;
            color: #dc3545;
            position: absolute;
            top: 5px;
            right: 10px;
        }

            .btn-delete:hover {
                color: #a71d2a;
            }
    </style>
}

@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    <script>
        // Inicializar SortableJS para cada coluna
        ['todo', 'doing', 'done'].forEach(id => {
            new Sortable(document.querySelector(`#${id} .kanban-list`), {
                group: 'kanban',
                animation: 150
            });
        });

        // Botão de adicionar card
        document.getElementById("addCardBtn").addEventListener("click", function(){
            const tempId = Date.now();
            const title = prompt("Digite o título do card:");
            const description = prompt("Digite a descrição/assunto do card:");
            if (!title) return;

            const card = document.createElement("div");
            card.className = "kanban-item";
            card.dataset.id = tempId;

            card.innerHTML =
                "<strong>" + title + "</strong><br>" +
                "<small>" + (description || "") + "</small>" +
                "<span class='btn-delete' onclick='deleteCard(event," + tempId + ")'>" +
                "<i class='bi bi-trash'></i>" +
                "</span>";

            document.querySelector("#todo .kanban-list").appendChild(card);
        });

        // Função de excluir card
        function deleteCard(e, id){
            e.stopPropagation();
            const card = document.querySelector('.kanban-item[data-id="' + id + '"]');
            if (card) card.remove();
        }
    </script>
}
